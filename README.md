# DyGETViz

## Installation


```bash
conda install scikit-learn pandas numpy matplotlib plotly
conda install -c conda-forge umap
pip install 
```


Please refer to the homepage of [PyTorch](https://pytorch.org/get-started/locally/), [PyTorch Geometric](https://pytorch-geometric.readthedocs.io/en/latest/install/installation.html), [PyTorch Geometric Temporal](https://pytorch-geometric-temporal.readthedocs.io/en/latest/notes/installation.html) to install these 3 packages, respectively. 



## Getting Started

### Procedures of thie cide

- Step 1: Discrete-Time Dynamic Graph (DTDG) embedding training
  - We use the [GConvGRU](https://pytorch-geometric-temporal.readthedocs.io/en/latest/modules/root.html) model from PyTorch Geometric Temporal to train embeddings of all datasets
  - We extended the dataloader so that. The original dataloader only used static input at each snapshots.
  - Note: This part is not included in the code yet. We directly provide the embeddings


Step 2: Embedding Trajectories Generation

Input: embeddings of shape (T, N, D)

- T: The number of timestamps / snapshots
- N: The number of nodes
- D: Embedding dimension

Output: JSON file that store the embedding trajectory for Dash


Step 3: Visualizing in a Dash app interactively using the JSON file

- Users should be able to incrementally add node trajectories  / all nodes under a certain category (e.g., normal users v.s. anomalous users) to the visualization


- highlighted_nodes: List of nodes to be highlighted in the visualization. We need to specify these nodes because we only show the names of a small number of nodes in the plotly visualization. Otherwise, the generated plot will be too messy. 


- **plot_dtdg.py**: Script for generating the visualization
- 

Generate the visualization using the command:

```bash
python dygetviz/plot_dtdg.py --dataset_name <DATASET_NAME> --model GConvGRU
```

Currently, `DATASET_NAME` can be selected from one of: `Ant`, `Chickenpox`, `DGraphFin`, `Reddit`



```bash
python dygetviz/plot_dtdg.py --dataset_name Chickenpox --model GConvGRU

python dygetviz/plot_dash.py --dataset_name Chickenpox --model GConvGRU
```

## Terminology

- `DG`: Dynamic Graph
- `DTDG`: Discrete-Time Dynamic Graphs
- `Embedding Trajectories`: Please refer to the [JODIE paper (KDD2019)]() for more details


## Explanation of Each Data File

- `node2idx`: A dictionary that maps node names to node indices (usually starting from 0 to #nodes-1).
- `embeds_<DATASET_NAME>.npy`: The node embeddings generated by DyGET. The shape of the embeddings is `#nodes x #time_steps x #embedding_dim`.


## Note



- The Reddit dataset is a bit special because it is the only dataset that describes a bipartite graph. The first 60 snapshots are for each of the 60 snapshots. The last snapshot is for the background nodes. The shape of the embeddings is `` 

## Acknowledgments

We thank members of the CLAWS Lab and SRI International for their feedback and support.


